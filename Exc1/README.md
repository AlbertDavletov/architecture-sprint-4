# Задание 1. Планирование: анализ, идентификация проблем и поиск решений

## Проблемы

- Задержки с обработкой заказами, т.к. сервис перегружен в связи с ростом количества пользователей.
- Все инстансы развернуты только в одном экземпляре. В случае выхода из строя одного из них, вся система перестанет работать.
- Базы данных перегружены, т.к. операции чтения и записи выполняются в одном инстансе. Нет репликации.
- Задержки с выходом новых релизов. Скорее всего связаны с монолитной архитектурой онлайн магазина и CRM системы, поэтому требуется более тщательное тестирование всего функционала.
- Нет сервиса мониторинга и логирования, поэтому сложно понять, где "потерялся" заказ.
- Данные для первой страницы MES не кэшируются, а дергаются напрямую из БД, что замедляет время запросов. Отсутствует кэширование.
- CI/CD реализован не полностью. Нет интеграционных тестов и нагрузочных тестов.
- E2E тесты выполняются вручную, что усложняет и замедляет выпуск новых релизов.
- Низкая отказоустойчивость.
- Непродуманная бизнес-логика принятия заказов операторами, они вынуждены "драться" за заказы на дашборде.

## Инициативы

1. Добавить трейсинг, логирование и мониторинг.
    - Необходимо определить самые узкие места системы и понять, где чаще всего "теряются" заказы.
    - Хотя узкие места видны невооруженным взглядом, отчеты мониторинга системы помогут обосновать правильность стратегии и приоритетов работы над блоками системы для бизнеса. 

2. Улучшить производительность сервиса MES.
    - Добавить инстансы для этого сервиса.
    - Рассмотреть возможность вертикального масштабирования, т.к. расчет стоимости заказа зависит от сложности полигонов в 3d модели и необходимы большие вычислительные мощности.
    - Добавить реплики чтения и записи для MES db.
    - Добавить микросервис уведомлений. Операторы смогут подписаться на появление новых заказов, а клиенты на изменение статуса заказа.

3. Изменить бизнес логику для принятия заказов операторами для уменьшения нагрузки на дашборд. Бизнес идеи.
    - Ввести рейтинг операторов и уровень сложности заказов. Операторы с высоким рейтингов смогут видеть все заказы на дашборде, с низким рейтингов - только простые.
    - Показывать на дашборде только новые заказы, выполенные заказы убрать в архив или на страницу оператора.

4. Автоматизировать тесты, улучшить CI/CD.
    - Добавить нагрузочные, интеграционные и E2E тесты в CI/CD пайплан.
    - После этого можно деплоить изменения и в release окружение автоматически. Тогда каждая версия в release окружении будет условно стабильная. 
    - QA инженер будет отвечать за выбор версии из release окружения для выхода в прод.

5. Добавить кэширование данных.
    - Товары в магазине.
    - Профили операторов, клиентов.
    - Новые заказы в дашборде MES.

6. Паттерн [Feature Toggles](https://martinfowler.com/articles/feature-toggles.html) для выпуска новых функций, A/B тестирование.
    - Новые функции можно выпускать используя паттерн Feature toggle, т.е. спрятав за флагом. Переключатель флагов будет контролироваться отдельным деплойментом. Это позволит проводить A/B тестирование новых функций для определенного количества пользователей. Если функция не будет работать, не потребуется откатывать релиз, достаточно будет переключить флаг.

7. Масштабирование сервисов.
    - Исходя из мониторинга, можно будет определить какие еще инстансы требуют немедленного масштабирования. Нужно будет оценить приоритет сервисов и возможности компании по дополнительным затратам.

8. Переписать софт MES или адаптировать код в свою кодовую базу.
    - Адаптировать сторонний софт MES под нужды CRM и компании.
    - Добавить/улучшить документацию.
    - Переписать софт на Java, иначе придется нанимать разработчиков под разные языки программирования и платформы.

9. Подумать над переходом на микросервисную архитектуру.
    - Если рост бизнеса продолжится, нагрузка на CRM и MES будет увеличиваться. Поэтому понадобится дорожная карта перехода на микросервисы. 

10. Набрать новых инженеров.
    - Если сроки сжатые и планируются дальнейшие планы по росту и развитию бизнеса, необходимо начать поиск новых инженеров для расширения команды. Потребуется как минимум один инженер, знающий Java и C#, а также дополнительный DevOps инженер.
    - Первый инженер потребуется для дальнейшей адаптации стороннего софта MES в единую кодовую базу компании и документации. Это критический сервис бизнеса, поэтому затраты будут оправданы.
    - Дополнительный DevOps инженер потребуется для масштабирования всей системы и автоматизации CI/CD пайплана. Также он потребуется для будущей трансформации системы под микросервисы.

## Планирование

1. Все инициативы были приведены в порядке приоритета.
2. Первые 5 инициатив критичны для нормальной работы системы. Их можно реализовать в первые 3 месяца, используя текущую команду.
3. В следующие 3 месяца можно выполнять 6 и 7 инициативу.
4. Через полгода система останется в прежней конфигурации, но все ключевые сервисы будут лучше масштабированы и справляться с текущей нагрузкой.
5. В следующие полгода можно начать переход на микросервисы (инициативы 8-10).
